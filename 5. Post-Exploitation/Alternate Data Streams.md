# Alternate Data Streams (ADS) Cheat Sheet  

**Alternate Data Streams (ADS)** are a feature of the NTFS file system that allow files to contain multiple streams of data, enabling attackers to hide malicious files or data within legitimate files to evade detection.  

---

## **Understanding ADS**  
- **Data Stream**: The default stream containing the actual data of the file.  
- **Resource Stream**: An additional stream that can store metadata or arbitrary hidden data.  

ADS is commonly abused by attackers to hide executables, malicious code, or data inside legitimate files. This technique is effective for evading basic antivirus (AV) signature detection and static scanning tools.  

---

## **Key Commands for Working with ADS in Windows**  

### **1. Viewing ADS Data in Files**
- Use the `dir /R` command to list files and display their alternate data streams:  
  ```cmd
  dir /R
  ```
  Example:  
  ```cmd
  C:\> dir /R
  Volume in drive C has no label.
  Volume Serial Number is XXXX-XXXX
  Directory of C:\ 
  11/19/2024  01:23 PM           0 test.txt
                        26 test.txt:secret.txt
  ```
  - `test.txt` is the main file.  
  - `test.txt:secret.txt` is the alternate data stream.  

- **Reading the ADS Data:**  
  Use the `more` command to read the contents of a stream:  
  ```cmd
  C:\> more < test.txt:secret.txt
  ```
  Alternatively, use `notepad` to open it:  
  ```cmd
  C:\> notepad test.txt:secret.txt
  ```

---

### **2. Creating and Managing ADS**  

#### **a. Create a File with Normal Content**  
Create a standard text file:  
```cmd
C:\> notepad test.txt
```

#### **b. Add Hidden Content to the ADS**  
Create hidden data in an alternate stream:  
```cmd
C:\> notepad test.txt:secret.txt
```

Reopen the hidden stream to edit:  
```cmd
C:\> notepad test.txt:secret.txt
```

#### **c. Hide an Executable in ADS**  
Store an executable inside an alternate stream:  
```cmd
C:\> type payload.exe > test.txt:secret.exe
```

#### **d. Execute the Hidden Executable**  
To execute the hidden payload, create a symbolic link:  
1. Run `cmd` as administrator.  
2. Create the symbolic link:  
   ```cmd
   C:\> mklink winupdate.exe test.txt:secret.exe
   ```
3. Run the payload using the symbolic link:  
   ```cmd
   C:\> winupdate.exe
   ```

> **Note**: To use this on another machine, you must copy both `test.txt` and `winupdate.exe`.

---